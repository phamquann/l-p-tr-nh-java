<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" lang="vi">
<head th:replace="~{admin/fragments::admin-head}"></head>

<body>
    <div class="container-fluid p-0">
        <div class="row g-0">
            <nav th:replace="~{admin/fragments::sidebar('dashboard')}"></nav>

            <main class="main-content">
                <div th:replace="~{admin/fragments::topbar('üìä Dashboard', 'T·ªïng quan h·ªá th·ªëng')}"></div>
                <div class="px-4">
                    <th:block th:replace="~{fragments/flash-messages::flash-messages}"></th:block>
                </div>

                <div class="container-fluid px-4">
    <!-- Stats Cards -->
    <div class="row g-4 mb-4">
        <div class="col-xl-3 col-md-6">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small text-uppercase">T·ªïng s·∫£n ph·∫©m</div>
                            <div class="h2 mb-0 text-primary" th:text="${totalBooks ?: 0}">0</div>
                            <small class="text-success"><i class="bi bi-arrow-up"></i> +12% th√°ng n√†y</small>
                        </div>
                        <div class="display-4 text-primary opacity-25">
                            <i class="bi bi-book-fill"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small text-uppercase">Ng∆∞·ªùi d√πng</div>
                            <div class="h2 mb-0 text-success" th:text="${totalUsers ?: 0}">0</div>
                            <small class="text-success"><i class="bi bi-arrow-up"></i> +5% th√°ng n√†y</small>
                        </div>
                        <div class="display-4 text-success opacity-25">
                            <i class="bi bi-people-fill"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small text-uppercase">ƒê∆°n h√†ng</div>
                            <div class="h2 mb-0 text-warning" th:text="${totalOrders ?: 0}">0</div>
                            <small class="text-muted"><i class="bi bi-dash"></i> Ch∆∞a c√≥ d·ªØ li·ªáu</small>
                        </div>
                        <div class="display-4 text-warning opacity-25">
                            <i class="bi bi-cart-check-fill"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small text-uppercase">Danh m·ª•c</div>
                            <div class="h2 mb-0 text-info" th:text="${totalCategories ?: 0}">0</div>
                            <small class="text-success"><i class="bi bi-arrow-up"></i> +2 danh m·ª•c m·ªõi</small>
                        </div>
                        <div class="display-4 text-info opacity-25">
                            <i class="bi bi-tags-fill"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Order Status Stats -->
    <div class="row g-4 mb-4">
        <div class="col-lg-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white">
                    <h5 class="mb-0"><i class="bi bi-cart-check text-success"></i> Tr·∫°ng th√°i ƒë∆°n h√†ng</h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-2">
                            <div class="text-center p-3 bg-warning bg-opacity-10 rounded">
                                <h4 class="text-warning mb-1" th:text="${pendingOrders ?: 0}">0</h4>
                                <small class="text-muted">Ch·ªù x√°c nh·∫≠n</small>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="text-center p-3 bg-info bg-opacity-10 rounded">
                                <h4 class="text-info mb-1" th:text="${confirmedOrders ?: 0}">0</h4>
                                <small class="text-muted">ƒê√£ x√°c nh·∫≠n</small>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="text-center p-3 bg-primary bg-opacity-10 rounded">
                                <h4 class="text-primary mb-1" th:text="${shippingOrders ?: 0}">0</h4>
                                <small class="text-muted">ƒêang giao</small>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="text-center p-3 bg-success bg-opacity-10 rounded">
                                <h4 class="text-success mb-1" th:text="${completedOrders ?: 0}">0</h4>
                                <small class="text-muted">Ho√†n th√†nh</small>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="text-center p-3 bg-danger bg-opacity-10 rounded">
                                <h4 class="text-danger mb-1" th:text="${cancelledOrders ?: 0}">0</h4>
                                <small class="text-muted">ƒê√£ h·ªßy</small>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="text-center p-3 bg-dark bg-opacity-10 rounded">
                                <h4 class="text-dark mb-1" th:text="${totalOrders ?: 0}">0</h4>
                                <small class="text-muted">T·ªïng ƒë∆°n</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Voucher Stats -->
    <div class="row g-4 mb-4">
        <div class="col-lg-6">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small text-uppercase">T·ªïng voucher</div>
                            <div class="h2 mb-0" style="color: #9b59b6;" th:text="${totalVouchers ?: 0}">0</div>
                            <small class="text-info"><i class="bi bi-ticket-perforated"></i> T·∫•t c·∫£ m√£ gi·∫£m gi√°</small>
                        </div>
                        <div class="display-4 opacity-25" style="color: #9b59b6;">
                            <i class="bi bi-ticket-detailed-fill"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small text-uppercase">Voucher kh·∫£ d·ª•ng</div>
                            <div class="h2 mb-0 text-success" th:text="${validVouchers ?: 0}">0</div>
                            <small class="text-success"><i class="bi bi-check-circle"></i> ƒêang ho·∫°t ƒë·ªông</small>
                        </div>
                        <div class="display-4 text-success opacity-25">
                            <i class="bi bi-ticket-perforated-fill"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Charts & Tables -->
    <div class="row g-4">
        <div class="col-lg-8">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white border-bottom">
                    <h5 class="mb-0"><i class="bi bi-graph-up text-primary"></i> S·∫£n ph·∫©m m·ªõi nh·∫•t</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover align-middle">
                            <thead class="table-light">
                                <tr>
                                    <th width="8%">ID</th>
                                    <th width="35%">T√™n s√°ch</th>
                                    <th width="25%">T√°c gi·∫£</th>
                                    <th width="17%" class="text-end">Gi√°</th>
                                    <th width="15%">Danh m·ª•c</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="book : ${recentBooks}">
                                    <td><strong th:text="${book.id}">1</strong></td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-book text-primary me-2"></i>
                                            <span th:text="${book.title}">Clean Code</span>
                                        </div>
                                    </td>
                                    <td th:text="${book.author}">Robert Martin</td>
                                    <td class="text-end">
                                        <strong th:text="${#numbers.formatDecimal(book.price, 0, 0)} + 'ƒë'">350,000ƒë</strong>
                                    </td>
                                    <td>
                                        <span class="badge bg-primary" th:text="${book.category?.name ?: 'N/A'}">IT</span>
                                    </td>
                                </tr>
                                <tr th:if="${recentBooks == null || #lists.isEmpty(recentBooks)}">
                                    <td colspan="5" class="text-center py-5">
                                        <i class="bi bi-inbox text-muted" style="font-size: 48px;"></i>
                                        <p class="text-muted mt-3">Ch∆∞a c√≥ s·∫£n ph·∫©m n√†o trong h·ªá th·ªëng</p>
                                        <a th:href="@{/books/add}" class="btn btn-primary btn-sm">
                                            <i class="bi bi-plus-circle"></i> Th√™m s·∫£n ph·∫©m ƒë·∫ßu ti√™n
                                        </a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="text-center mt-3" th:if="${recentBooks != null && !#lists.isEmpty(recentBooks)}">
                        <a th:href="@{/admin/products}" class="btn btn-outline-primary">
                            <i class="bi bi-arrow-right"></i> Xem t·∫•t c·∫£ s·∫£n ph·∫©m
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white border-bottom">
                    <h5 class="mb-0"><i class="bi bi-activity text-success"></i> Ho·∫°t ƒë·ªông g·∫ßn ƒë√¢y</h5>
                </div>
                <div class="card-body">
                    <div class="d-flex gap-3 mb-3 pb-3 border-bottom">
                        <div class="bg-primary bg-opacity-10 text-primary rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                            <i class="bi bi-plus-circle-fill"></i>
                        </div>
                        <div class="flex-grow-1">
                            <div class="fw-semibold">Th√™m s·∫£n ph·∫©m m·ªõi</div>
                            <div class="text-muted small">
                                <i class="bi bi-clock"></i> 5 ph√∫t tr∆∞·ªõc
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex gap-3 mb-3 pb-3 border-bottom">
                        <div class="bg-success bg-opacity-10 text-success rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                            <i class="bi bi-person-plus-fill"></i>
                        </div>
                        <div class="flex-grow-1">
                            <div class="fw-semibold">Ng∆∞·ªùi d√πng m·ªõi ƒëƒÉng k√Ω</div>
                            <div class="text-muted small">
                                <i class="bi bi-clock"></i> 15 ph√∫t tr∆∞·ªõc
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex gap-3 mb-3 pb-3 border-bottom">
                        <div class="bg-warning bg-opacity-10 text-warning rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                            <i class="bi bi-cart-fill"></i>
                        </div>
                        <div class="flex-grow-1">
                            <div class="fw-semibold">ƒê∆°n h√†ng m·ªõi</div>
                            <div class="text-muted small">
                                <i class="bi bi-clock"></i> 30 ph√∫t tr∆∞·ªõc
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex gap-3 mb-3 pb-3 border-bottom">
                        <div class="bg-info bg-opacity-10 text-info rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                            <i class="bi bi-pencil-square"></i>
                        </div>
                        <div class="flex-grow-1">
                            <div class="fw-semibold">C·∫≠p nh·∫≠t th√¥ng tin s·∫£n ph·∫©m</div>
                            <div class="text-muted small">
                                <i class="bi bi-clock"></i> 1 gi·ªù tr∆∞·ªõc
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex gap-3">
                        <div class="bg-danger bg-opacity-10 text-danger rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                            <i class="bi bi-trash-fill"></i>
                        </div>
                        <div class="flex-grow-1">
                            <div class="fw-semibold">X√≥a s·∫£n ph·∫©m h·∫øt h√†ng</div>
                            <div class="text-muted small">
                                <i class="bi bi-clock"></i> 2 gi·ªù tr∆∞·ªõc
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="card border-0 shadow-sm mt-4">
                <div class="card-header bg-white border-bottom">
                    <h5 class="mb-0"><i class="bi bi-lightning-fill text-warning"></i> Thao t√°c nhanh</h5>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <a th:href="@{/books/add}" class="btn btn-primary">
                            <i class="bi bi-plus-circle"></i> Th√™m s·∫£n ph·∫©m m·ªõi
                        </a>
                        <a th:href="@{/admin/vouchers/add}" class="btn btn-outline-secondary" style="border-color: #9b59b6; color: #9b59b6;">
                            <i class="bi bi-ticket-perforated"></i> T·∫°o voucher m·ªõi
                        </a>
                        <a th:href="@{/admin/users}" class="btn btn-outline-success">
                            <i class="bi bi-people"></i> Qu·∫£n l√Ω ng∆∞·ªùi d√πng
                        </a>
                        <a th:href="@{/admin/chat}" class="btn btn-outline-info">
                            <i class="bi bi-chat-dots"></i> Tr√≤ chuy·ªán kh√°ch h√†ng
                        </a>
                        <a th:href="@{/admin/reports}" class="btn btn-outline-warning">
                            <i class="bi bi-graph-up"></i> Xem b√°o c√°o
                        </a>
                    </div>
                </div>
            </div>
        </div>
                </div>
            </main>
        </div>
    </div>

    <script th:src="@{/js/bootstrap.min.js}"></script>
</body>
</html>

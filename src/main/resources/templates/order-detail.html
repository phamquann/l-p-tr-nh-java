<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security" 
      lang="vi">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="'üì¶ ƒê∆°n h√†ng #' + ${order.id} + ' - HUTECH'">Chi ti·∫øt ƒë∆°n h√†ng</title>
    <th:block th:replace="~{layout::link-css}"></th:block>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .detail-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        
        .back-link {
            color: white;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 20px;
            padding: 10px 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 50px;
            transition: all 0.3s ease;
        }
        
        .back-link:hover {
            background: rgba(255,255,255,0.3);
            color: white;
        }
        
        .order-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            margin-bottom: 25px;
        }
        
        .order-card-header {
            padding: 30px;
            position: relative;
        }
        
        .order-card-header.pending {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        }
        
        .order-card-header.confirmed {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }
        
        .order-card-header.shipping {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .order-card-header.completed {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }
        
        .order-card-header.cancelled {
            background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
            color: white;
        }
        
        .order-number {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .order-status-large {
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .order-status-icon {
            font-size: 2rem;
        }
        
        .order-card-body {
            padding: 30px;
        }
        
        .section-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Status Progress */
        .status-progress {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            position: relative;
        }
        
        .status-progress::before {
            content: '';
            position: absolute;
            top: 25px;
            left: 10%;
            right: 10%;
            height: 4px;
            background: #e0e0e0;
            z-index: 0;
        }
        
        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 1;
            flex: 1;
        }
        
        .step-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }
        
        .step-icon.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
            animation: pulse 2s infinite;
        }
        
        .step-icon.completed {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .step-label {
            font-size: 0.85rem;
            color: #666;
            text-align: center;
        }
        
        .step-label.active {
            color: #667eea;
            font-weight: bold;
        }
        
        /* Products */
        .product-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .product-item:last-child {
            border-bottom: none;
        }
        
        .product-icon {
            font-size: 2.5rem;
            margin-right: 15px;
        }
        
        .product-info {
            flex: 1;
        }
        
        .product-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .product-author {
            color: #888;
            font-size: 0.9rem;
        }
        
        .product-qty {
            color: #666;
            margin-right: 20px;
        }
        
        .product-price {
            font-weight: bold;
            color: #667eea;
            font-size: 1.1rem;
        }
        
        /* Summary */
        .order-summary {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
        }
        
        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px dashed #e0e0e0;
        }
        
        .summary-row:last-child {
            border-bottom: none;
        }
        
        .summary-row.total {
            font-size: 1.3rem;
            font-weight: bold;
            padding-top: 15px;
            margin-top: 10px;
            border-top: 2px solid #667eea;
        }
        
        .summary-row.total .summary-value {
            color: #667eea;
        }
        
        /* Info Grid */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .info-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
        }
        
        .info-label {
            font-size: 0.8rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }
        
        .info-value {
            font-weight: 600;
            color: #333;
        }
        
        @media (max-width: 768px) {
            .status-progress {
                flex-direction: column;
                gap: 20px;
            }
            
            .status-progress::before {
                display: none;
            }
            
            .progress-step {
                flex-direction: row;
                gap: 15px;
            }
            
            .step-icon {
                margin-bottom: 0;
            }
            
            .product-item {
                flex-wrap: wrap;
            }
        }
    </style>
</head>

<body>

<th:block th:replace="~{layout::header}"></th:block>

<div class="detail-container">
    <a href="/profile/orders" class="back-link">
        ‚Üê Quay l·∫°i danh s√°ch ƒë∆°n h√†ng
    </a>
    
    <!-- Order Header Card -->
    <div class="order-card">
        <div class="order-card-header"
             th:classappend="${order.status == 'PENDING'} ? 'pending' : 
                             (${order.status == 'CONFIRMED'} ? 'confirmed' : 
                             (${order.status == 'SHIPPING'} ? 'shipping' : 
                             (${order.status == 'COMPLETED'} ? 'completed' : 'cancelled')))">
            <div class="order-number">ƒê∆°n h√†ng #<span th:text="${order.id}"></span></div>
            <div class="order-status-large">
                <span class="order-status-icon"
                      th:text="${order.status == 'PENDING'} ? '‚è≥' : 
                               (${order.status == 'CONFIRMED'} ? '‚úÖ' : 
                               (${order.status == 'SHIPPING'} ? 'üöö' : 
                               (${order.status == 'COMPLETED'} ? 'üéâ' : '‚ùå')))">
                </span>
                <span th:text="${order.status == 'PENDING'} ? 'ƒêang ch·ªù x·ª≠ l√Ω' : 
                               (${order.status == 'CONFIRMED'} ? 'ƒê√£ x√°c nh·∫≠n ƒë∆°n h√†ng' : 
                               (${order.status == 'SHIPPING'} ? 'ƒêang giao h√†ng ƒë·∫øn b·∫°n' : 
                               (${order.status == 'COMPLETED'} ? 'ƒê√£ giao h√†ng th√†nh c√¥ng' : 'ƒê∆°n h√†ng ƒë√£ b·ªã h·ªßy')))">
                </span>
            </div>
        </div>
        
        <div class="order-card-body">
            <!-- Status Progress -->
            <div th:if="${order.status != 'CANCELLED'}" class="status-progress">
                <div class="progress-step">
                    <div class="step-icon completed">üìù</div>
                    <span class="step-label">ƒê·∫∑t h√†ng</span>
                </div>
                <div class="progress-step">
                    <div class="step-icon"
                         th:classappend="${order.status == 'CONFIRMED' || order.status == 'SHIPPING' || order.status == 'COMPLETED'} ? 'completed' : ''">
                        ‚úÖ
                    </div>
                    <span class="step-label" th:classappend="${order.status == 'CONFIRMED'} ? 'active' : ''">X√°c nh·∫≠n</span>
                </div>
                <div class="progress-step">
                    <div class="step-icon"
                         th:classappend="${order.status == 'SHIPPING'} ? 'active' : (${order.status == 'COMPLETED'} ? 'completed' : '')">
                        üöö
                    </div>
                    <span class="step-label" th:classappend="${order.status == 'SHIPPING'} ? 'active' : ''">ƒêang giao</span>
                </div>
                <div class="progress-step">
                    <div class="step-icon"
                         th:classappend="${order.status == 'COMPLETED'} ? 'completed' : ''">
                        üéâ
                    </div>
                    <span class="step-label" th:classappend="${order.status == 'COMPLETED'} ? 'active' : ''">Ho√†n th√†nh</span>
                </div>
            </div>
            
            <!-- Cancelled Message -->
            <div th:if="${order.status == 'CANCELLED'}" class="alert alert-danger text-center">
                <i class="bi bi-x-circle-fill"></i> ƒê∆°n h√†ng n√†y ƒë√£ b·ªã h·ªßy
            </div>
        </div>
    </div>
    
    <!-- Delivery Info -->
    <div class="order-card">
        <div class="order-card-body">
            <div class="section-title">
                <i class="bi bi-geo-alt-fill"></i> Th√¥ng tin giao h√†ng
            </div>
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">Ng∆∞·ªùi nh·∫≠n</div>
                    <div class="info-value" th:text="${order.customerName}">T√™n ng∆∞·ªùi nh·∫≠n</div>
                </div>
                <div class="info-item">
                    <div class="info-label">S·ªë ƒëi·ªán tho·∫°i</div>
                    <div class="info-value" th:text="${order.customerPhone}">0123456789</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Email</div>
                    <div class="info-value" th:text="${order.customerEmail}">email@example.com</div>
                </div>
                <div class="info-item">
                    <div class="info-label">ƒê·ªãa ch·ªâ</div>
                    <div class="info-value" th:text="${order.customerAddress}">ƒê·ªãa ch·ªâ giao h√†ng</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Products -->
    <div class="order-card">
        <div class="order-card-body">
            <div class="section-title">
                <i class="bi bi-box-seam-fill"></i> S·∫£n ph·∫©m ƒë√£ ƒë·∫∑t
            </div>
            
            <div th:each="item : ${orderItems}" class="product-item">
                <div class="product-icon">üìñ</div>
                <div class="product-info">
                    <div class="product-title" th:text="${item.book.title}">T√™n s√°ch</div>
                    <div class="product-author">‚úçÔ∏è <span th:text="${item.book.author}">T√°c gi·∫£</span></div>
                </div>
                <div class="product-qty">
                    x<span th:text="${item.quantity}">1</span>
                </div>
                <div class="product-price" th:text="${#numbers.formatDecimal(item.price * item.quantity, 1, 0)} + 'ƒë'">0ƒë</div>
            </div>
            
            <!-- Order Summary -->
            <div class="order-summary">
                <div class="summary-row">
                    <span>Ng√†y ƒë·∫∑t h√†ng</span>
                    <span th:text="${#temporals.format(order.createdAt, 'dd/MM/yyyy HH:mm')}">01/01/2024</span>
                </div>
                <div class="summary-row">
                    <span>C·∫≠p nh·∫≠t l·∫ßn cu·ªëi</span>
                    <span th:text="${#temporals.format(order.updatedAt, 'dd/MM/yyyy HH:mm')}">01/01/2024</span>
                </div>
                <div class="summary-row total">
                    <span>T·ªïng thanh to√°n</span>
                    <span class="summary-value" th:text="${#numbers.formatDecimal(order.totalAmount, 1, 0)} + 'ƒë'">0ƒë</span>
                </div>
            </div>
        </div>
    </div>
</div>

<th:block th:replace="~{layout::footer}"></th:block>

</body>
</html>
